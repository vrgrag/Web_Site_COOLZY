{"ast":null,"code":"var _jsxFileName = \"H:\\\\Website\\\\Website_Technical_Store\\\\react-website\\\\src\\\\Components\\\\Cart\\\\Cart.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Cart() {\n  _s();\n  const [cartItems, setCartItems] = useState([]);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const user = JSON.parse(localStorage.getItem(\"user\"));\n    if (!(user !== null && user !== void 0 && user.userId)) return;\n    fetch(`http://localhost:5085/api/cart/${user.userId}`).then(res => res.json()).then(data => {\n      const items = Array.isArray(data.items) ? data.items : [];\n      setCartItems(items);\n    }).catch(err => console.error(\"Ошибка загрузки корзины\", err));\n  }, []);\n  const calculateTotal = () => {\n    return cartItems.reduce((sum, item) => sum + item.quantity * item.product.newPrice, 0);\n  };\n  const handleCheckout = () => {\n    const validCartItems = cartItems.map(item => {\n      var _item$product;\n      return {\n        productId: ((_item$product = item.product) === null || _item$product === void 0 ? void 0 : _item$product.productId) || item.productId,\n        quantity: item.quantity\n      };\n    }).filter(item => Number.isInteger(item.productId) && item.quantity > 0);\n    if (validCartItems.length === 0) {\n      alert(\"Корзина пуста или содержит некорректные товары\");\n      return;\n    }\n    navigate(\"/checkout\", {\n      state: {\n        cartItems: validCartItems,\n        total: calculateTotal()\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 20\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }, this), cartItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \\u043F\\u0443\\u0441\\u0442\\u0430\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n        children: cartItems.map(item => {\n          var _item$product2, _item$product3;\n          return /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [((_item$product2 = item.product) === null || _item$product2 === void 0 ? void 0 : _item$product2.model) || 'Товар', \" \\u2014 \", item.quantity, \" \\xD7 \", (_item$product3 = item.product) === null || _item$product3 === void 0 ? void 0 : _item$product3.newPrice, \" \\u0440\\u0443\\u0431.\"]\n          }, item.productId, true, {\n            fileName: _jsxFileName,\n            lineNumber: 51,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"\\u0418\\u0442\\u043E\\u0433\\u043E:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 14\n        }, this), \" \", calculateTotal(), \" \\u0440\\u0443\\u0431.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleCheckout,\n        children: \"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u043A \\u043E\\u0444\\u043E\\u0440\\u043C\\u043B\\u0435\\u043D\\u0438\\u044E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 42,\n    columnNumber: 5\n  }, this);\n}\n_s(Cart, \"X1Cg+yrFJT2G/h4BSNE9/5vv8jY=\", false, function () {\n  return [useNavigate];\n});\n_c = Cart;\nvar _c;\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","Cart","_s","cartItems","setCartItems","navigate","user","JSON","parse","localStorage","getItem","userId","fetch","then","res","json","data","items","Array","isArray","catch","err","console","error","calculateTotal","reduce","sum","item","quantity","product","newPrice","handleCheckout","validCartItems","map","_item$product","productId","filter","Number","isInteger","length","alert","state","total","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","_item$product2","_item$product3","model","onClick","_c","$RefreshReg$"],"sources":["H:/Website/Website_Technical_Store/react-website/src/Components/Cart/Cart.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nexport default function Cart() {\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const user = JSON.parse(localStorage.getItem(\"user\"));\r\n    if (!user?.userId) return;\r\n\r\n    fetch(`http://localhost:5085/api/cart/${user.userId}`)\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        const items = Array.isArray(data.items) ? data.items : [];\r\n        setCartItems(items);\r\n      })\r\n      .catch(err => console.error(\"Ошибка загрузки корзины\", err));\r\n  }, []);\r\n\r\n  const calculateTotal = () => {\r\n    return cartItems.reduce((sum, item) => sum + item.quantity * item.product.newPrice, 0);\r\n  };\r\n\r\n  const handleCheckout = () => {\r\n    const validCartItems = cartItems.map(item => ({\r\n      productId: item.product?.productId || item.productId,\r\n      quantity: item.quantity\r\n    })).filter(item => Number.isInteger(item.productId) && item.quantity > 0);\r\n\r\n    if (validCartItems.length === 0) {\r\n      alert(\"Корзина пуста или содержит некорректные товары\");\r\n      return;\r\n    }\r\n\r\n    navigate(\"/checkout\", {\r\n      state: { cartItems: validCartItems, total: calculateTotal() }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: 20 }}>\r\n      <h2>Корзина</h2>\r\n\r\n      {cartItems.length === 0 ? (\r\n        <p>Корзина пуста</p>\r\n      ) : (\r\n        <>\r\n          <ul>\r\n            {cartItems.map(item => (\r\n              <li key={item.productId}>\r\n                {item.product?.model || 'Товар'} — {item.quantity} × {item.product?.newPrice} руб.\r\n              </li>\r\n            ))}\r\n          </ul>\r\n          <p><b>Итого:</b> {calculateTotal()} руб.</p>\r\n          <button onClick={handleCheckout}>Перейти к оформлению</button>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}