{"ast":null,"code":"var _jsxFileName = \"H:\\\\Website\\\\Website_Technical_Store\\\\react-website\\\\src\\\\Components\\\\Cart\\\\Cart.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Cart = () => {\n  _s();\n  const [cartItems, setCartItems] = useState([]);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const savedCart = JSON.parse(localStorage.getItem(\"cart\")) || [];\n    setCartItems(savedCart);\n  }, []);\n  const handleRemove = productId => {\n    const updated = cartItems.filter(item => item.productId !== productId);\n    setCartItems(updated);\n    localStorage.setItem(\"cart\", JSON.stringify(updated));\n  };\n  const handleCheckout = async () => {\n    const storedUser = JSON.parse(localStorage.getItem(\"user\"));\n    if (!(storedUser !== null && storedUser !== void 0 && storedUser.userId) || cartItems.length === 0) {\n      alert(\"Корзина пуста или пользователь не вошёл в систему\");\n      return;\n    }\n    try {\n      const response = await fetch(\"http://localhost:5085/api/orders\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          userId: storedUser.userId,\n          items: cartItems.map(item => ({\n            productId: item.productId,\n            quantity: item.quantity\n          }))\n        })\n      });\n      if (response.ok) {\n        alert(\"Заказ успешно оформлен!\");\n        localStorage.removeItem(\"cart\");\n        setCartItems([]);\n        navigate(\"/profile\");\n      } else {\n        alert(\"Ошибка при оформлении заказа\");\n      }\n    } catch (err) {\n      console.error(\"Ошибка оформления:\", err);\n      alert(\"Произошла ошибка\");\n    }\n  };\n  const getTotal = () => {\n    return cartItems.reduce((sum, item) => sum + item.quantity * (item.price || 0), 0);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"cart-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), cartItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\u0412\\u0430\\u0448\\u0430 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \\u043F\\u0443\\u0441\\u0442\\u0430\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"cart-list\",\n        children: cartItems.map(item => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"cart-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: item.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"\\u0426\\u0435\\u043D\\u0430: \", item.price, \" BYN\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E: \", item.quantity]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleRemove(item.productId),\n            children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 17\n          }, this)]\n        }, item.productId, true, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"\\u0418\\u0442\\u043E\\u0433\\u043E: \", getTotal().toLocaleString(), \" BYN\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleCheckout,\n        children: \"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n};\n_s(Cart, \"X1Cg+yrFJT2G/h4BSNE9/5vv8jY=\", false, function () {\n  return [useNavigate];\n});\n_c = Cart;\nexport default Cart;\nvar _c;\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsxDEV","_jsxDEV","Cart","_s","cartItems","setCartItems","navigate","savedCart","JSON","parse","localStorage","getItem","handleRemove","productId","updated","filter","item","setItem","stringify","handleCheckout","storedUser","userId","length","alert","response","fetch","method","headers","body","items","map","quantity","ok","removeItem","err","console","error","getTotal","reduce","sum","price","className","children","fileName","_jsxFileName","lineNumber","columnNumber","name","onClick","toLocaleString","_c","$RefreshReg$"],"sources":["H:/Website/Website_Technical_Store/react-website/src/Components/Cart/Cart.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst Cart = () => {\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const savedCart = JSON.parse(localStorage.getItem(\"cart\")) || [];\r\n    setCartItems(savedCart);\r\n  }, []);\r\n\r\n  const handleRemove = (productId) => {\r\n    const updated = cartItems.filter(item => item.productId !== productId);\r\n    setCartItems(updated);\r\n    localStorage.setItem(\"cart\", JSON.stringify(updated));\r\n  };\r\n\r\n  const handleCheckout = async () => {\r\n    const storedUser = JSON.parse(localStorage.getItem(\"user\"));\r\n    if (!storedUser?.userId || cartItems.length === 0) {\r\n      alert(\"Корзина пуста или пользователь не вошёл в систему\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(\"http://localhost:5085/api/orders\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          userId: storedUser.userId,\r\n          items: cartItems.map(item => ({\r\n            productId: item.productId,\r\n            quantity: item.quantity\r\n          }))\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        alert(\"Заказ успешно оформлен!\");\r\n        localStorage.removeItem(\"cart\");\r\n        setCartItems([]);\r\n        navigate(\"/profile\");\r\n      } else {\r\n        alert(\"Ошибка при оформлении заказа\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Ошибка оформления:\", err);\r\n      alert(\"Произошла ошибка\");\r\n    }\r\n  };\r\n\r\n  const getTotal = () => {\r\n    return cartItems.reduce((sum, item) => sum + item.quantity * (item.price || 0), 0);\r\n  };\r\n\r\n  return (\r\n    <div className=\"cart-container\">\r\n      <h2>Корзина</h2>\r\n\r\n      {cartItems.length === 0 ? (\r\n        <p>Ваша корзина пуста</p>\r\n      ) : (\r\n        <div>\r\n          <ul className=\"cart-list\">\r\n            {cartItems.map(item => (\r\n              <li key={item.productId} className=\"cart-item\">\r\n                <h4>{item.name}</h4>\r\n                <p>Цена: {item.price} BYN</p>\r\n                <p>Количество: {item.quantity}</p>\r\n                <button onClick={() => handleRemove(item.productId)}>Удалить</button>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n\r\n          <h3>Итого: {getTotal().toLocaleString()} BYN</h3>\r\n          <button onClick={handleCheckout}>Оформить заказ</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Cart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}